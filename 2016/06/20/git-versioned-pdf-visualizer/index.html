<!DOCTYPE html><html lang="en"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Git Versioned PDF Visualizer | bonkerfield</title><meta name="description" content="personal information identity spacetime map"><meta itemprop="name" content="Will Stedden"><meta itemprop="description" content="personal information identity spacetime map"><meta itemprop="image" content="https://1.bp.blogspot.com/-VKPf9qgeyLY/V2hP1oPA9zI/AAAAAAAAGYk/K3C78Q2_9joKCPEIR9lA_uRYFh1N6YzugCLcB/hqdefault.jpg"><meta property="og:url" content="https://bonkerfield.org/2016/06/20/git-versioned-pdf-visualizer/"><meta property="og:type" content="website"><meta property="og:title" content="Git Versioned PDF Visualizer | bonkerfield"><meta property="og:site_name" content="bonkerfield"><meta property="og:description" content="personal information identity spacetime map"><meta property="og:image" content="https://1.bp.blogspot.com/-VKPf9qgeyLY/V2hP1oPA9zI/AAAAAAAAGYk/K3C78Q2_9joKCPEIR9lA_uRYFh1N6YzugCLcB/hqdefault.jpg"><meta name="twitter:url" content="https://bonkerfield.org/2016/06/20/git-versioned-pdf-visualizer/"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Git Versioned PDF Visualizer | bonkerfield"><meta name="twitter:site" content="bonkerfield"><meta name="twitter:description" content="personal information identity spacetime map"><meta name="twitter:creator" content="@willstedden"><meta property="twitter:image" content="https://1.bp.blogspot.com/-VKPf9qgeyLY/V2hP1oPA9zI/AAAAAAAAGYk/K3C78Q2_9joKCPEIR9lA_uRYFh1N6YzugCLcB/hqdefault.jpg"><link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico"><link rel="stylesheet" href="/assets/css/app.min.css"><link rel="alternate" type="application/rss+xml" title="bonkerfield" href="/feed.xml"><link rel="canonical" href="/2016/06/20/git-versioned-pdf-visualizer/"></head><body id="git-versioned-pdf-visualizer" class="post-layout"><header class="header"> <a class="header__title" href="/">bonkerfield</a><nav><ul class="header__list"><li><a href="/things">things</a></li><li><a href="/qmb">doings</a></li><li><span class="popup__open"><i class="fa fa-envelope"></i></span></li><li><a href="/search"><i class="fa fa-search"></i></a></li></ul></nav></header><main class="bonk"><div class="post"><article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting"><div class="post__header section-padding-half"><div class="grid-small"><h2 itemprop="name headline">Git Versioned PDF Visualizer</h2><time class="post__date" datetime="2016-06-20T13:20:00-07:00" itemprop="datePublished">2016·06·20</time><p class="post__date"></p></div></div><div class="post__content section-padding"><div class="grid"><div id="markdown" itemprop="articleBody"> <a href="https://github.com/lots-of-things/git-pdf-viz">jump to the code</a><p> I've been writing a <a href="https://github.com/wmcfadden/theseus" title="my PhD thesis">very long document</a> over the past couple of years. Because I love tracking my own behavior and <a href="https://en.wikipedia.org/wiki/Open_science">Open science</a>, I decided to version control the whole editing process of my thesis on GitHub. Because I've been keeping track of all my updates with git, that means I can monitor all the changes that have gone into my thesis over time. This can also be useful for <a href="http://danaernst.com/using-github-to-coauthor-papers/">collaborating on writing papers</a> too (though my prototypical Luddite advisor would rather do things by emailing <a href="http://www.apple.com/mac/pages/">Mac Pages</a> documents).</p><h4>Git PDF movie maker</h4><p> As a cool way to visualize all the changes, I wrote a series of a couple of scripts that checkout each version and make a movie out of all the .pdfs in the repo over time. Here's the current state (note that the thesis isn't even close to finished yet; I'll update when I get more on it.)</p><div style="text-align:center"><iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/mWvQ1Y5uaGc" width="420"></iframe></div><p> If you think you'd like to use this, you can bounce over to the <a href="https://github.com/lots-of-things/git-pdf-viz">git-pdf-viz GitHub repo</a> and download it now. Read on below for more info on how it works, how to modify it, and to see the results of running git-pdf-viz on my thesis.</p><h4>A Real Bash!</h4><p> Writing bash scripts is a party, I know. This entire project is comprised of just a few bash scripts that are meant to be run sequentially (with some editing maybe).</p><ol><li>save_all_pdfs</li><li>pdfs_to_ims</li><li>ims_to_montage</li><li>montage_to_frame</li><li>frame_to_movie</li></ol><h4>Save All PDFs</h4><p> The first script really takes care of the core of this program. There's lots of extra details but the key piece of save_all_pdfs.sh is "git rev-list master," which gives you all the commit ids for your repo. This pseudo-bash shows the general idea:</p><pre>
for commit in $(git rev-list master)
do
    git checkout $commit
    ...copy all pdfs to somewhere safe...
done
</pre><p> "git checkout" updates all the files that are sitting in the project directory locally. So with the list of revisions from "git rev-list master" I can reset the state of my file system to reflect the state at each committed phase of the project. After that, I just need to copy all the files I need (in this case my pdfs) somewhere safe for use later. (<strong>Caveat:</strong> I'm currently only copying pdfs if they have a corresponding latex file because I wanted to ignore any figures that weren't included. You can modify the script accordingly if you need all your pdfs copied.)</p><h4>Playing with pdfs and images</h4><p> The next three scripts rely on <a href="http://ghostscript.com/doc/current/Devices.htm">GhostScript</a> and <a href="http://www.imagemagick.org/script/index.php">ImageMagick suite</a> to jockey our pdfs into a composite image that will eventually be turned into movie frames. You can view the scripts themselves for more details about implementation, but I'll explain the idea behind each script for reference.</p><ul><li><strong>gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -sOutputFile=merged.pdf *.pdf </strong> uses ghostscript to merge all the saved pdfs together</li><li><strong>convert merged.pdf im/i_%03d.png</strong> converts the merged pdf to a sequence of individual pngs</li><li><strong>montage -mode concatenate -tile 10x i_* ../final.png</strong> stitches all the individual png "pages" into a "montage" panel with 10 columns</li><li><strong>convert "${now}/final.png" -resize 1000x -gravity northwest -background white -extent 1000x700 -colorspace RGB "PNG32:bydate/${now}.png"</strong> rescales each montage and ensures that all images are the same size and colorspace</li><li><strong>mogrify -gravity southeast -pointsize 26 -annotate +10+10 %t *.png</strong> adds a little timestamp (based on the title) in the southeast corner</li></ul><p> At the end of this process there will be a folder named bydate/ with an image for every frame of a movie that's about to get made.</p><h4>Lights, Camera, Action</h4><p> As the final step we use <a href="https://ffmpeg.org/">ffmpeg</a> to convert all of the images into an mp4 movie. This requires two lines because ffmpeg is made to work with numerically sequential files, and my files are named based on their date.</p><pre>
ls *.png | sort -V | xargs -I {} echo "file '{}'" &gt; list.txt
ffmpeg -r 2 -f concat -i list.txt -r 30 -c:v libx264 -pix_fmt yuv420p ../git_pdf_viz.mp4
</pre><p> This is a good example of how compicated ghostscript, ImageMagick, and ffmpeg can be to use. Through all of this there are about 20 extra parameters that have to get passed to each of these programs to make them work properly. I can't explain all of them in detail, so I recommend the individual software's documentation if you find you need to modify these extensively. These are <strong>amazingly</strong> powerful programs that make life so much easier for any kind of batch audiovisual project so I highly encourage getting acquainted with them at some point in your life.</p><p> Have fun, and I hope that this encourages you to use open source version control whenever you write/edit any large document project.</p></div><ul class="post__social"><li><a href="https://www.facebook.com/sharer/sharer.php?u=https://bonkerfield.org/2016/06/20/git-versioned-pdf-visualizer/" target="_blank"><i class="fa fa-facebook"></i></a></li><li><a href="https://twitter.com/intent/tweet?&text=Git Versioned PDF Visualizer+https://bonkerfield.org/2016/06/20/git-versioned-pdf-visualizer/+by+Will Stedden" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?mini=true&source=Git Versioned PDF Visualizer&summary=&url=https://bonkerfield.org/2016/06/20/git-versioned-pdf-visualizer/" target="_blank"><i class="fa fa-linkedin"></i></a></li><li><a href="https://www.stumbleupon.com/badge/?url=https://bonkerfield.org/2016/06/20/git-versioned-pdf-visualizer/" target="_blank"><i class="fa fa-stumbleupon"></i></a></li><li><a href="https://www.reddit.com/submit?url=https://bonkerfield.org/2016/06/20/git-versioned-pdf-visualizer/" target="_blank"><i class="fa fa-reddit-alien"></i></a></li><li><a href="https://www.tumblr.com/share/link?url=https://bonkerfield.org/2016/06/20/git-versioned-pdf-visualizer/" target="_blank"><i class="fa fa-tumblr"></i></a></li><li><a href="https://www.pinterest.com/pin/create/link/?description=&media=https://1.bp.blogspot.com/-VKPf9qgeyLY/V2hP1oPA9zI/AAAAAAAAGYk/K3C78Q2_9joKCPEIR9lA_uRYFh1N6YzugCLcB/hqdefault.jpg&url=https://bonkerfield.org/2016/06/20/git-versioned-pdf-visualizer/" target="_blank"><i class="fa fa-pinterest"></i></a></li></ul></div></div><div class="section-padding--none"><div class="grid"><hr class="sep" /></div></div><div class="section-padding"><div class="grid-small"> <span class="post__author">Posted by <a href="http://hellowill.bonkerfield.org" title="More By Will Stedden">Will Stedden</a></span><p class="post__bio"></p></div></div></article></div><section class="related section-padding"><div class="grid-xlarge"><h2 class="related__title">Related</h2><div class="related__container"><article class="related__post"> <a class="related__link" href="https://bonkerfield.org/2018/12/02/rtifice-website-revamp/"><figure class="related__img"> <img src="https://2.bp.blogspot.com/-k7IGUdP6QFE/XJGdGWRt_0I/AAAAAAAADkQ/NBd_jknvCxcIo_HMZqkWvSGYNu1GdkfSgCLcBGAs/Screen%2BShot%2B2019-03-19%2Bat%2B6.52.54%2BPM.png" alt="@rtifice Website Revamp" /></figure><div><h2 class="related__text">@rtifice Website Revamp</h2></div></a></article><article class="related__post"> <a class="related__link" href="https://bonkerfield.org/2016/10/12/text-mining-and-natural-language/"><figure class="related__img"> <img src="https://4.bp.blogspot.com/-eDtnSA_LrOk/V_6IY2EOMLI/AAAAAAAAHDE/cqVsQMqK4PQT5H720zmOrH-3aw-R6Tw8wCLcB/png%253Bbase64de1231217d364075.png" alt="Text Mining and Natural Language Processing on Health Forums" /></figure><div><h2 class="related__text">Text Mining and Natural Language Processing on Health Forums</h2></div></a></article><article class="related__post"> <a class="related__link" href="https://bonkerfield.org/2016/06/20/git-versioned-pdf-visualizer/"><figure class="related__img"> <img src="https://1.bp.blogspot.com/-VKPf9qgeyLY/V2hP1oPA9zI/AAAAAAAAGYk/K3C78Q2_9joKCPEIR9lA_uRYFh1N6YzugCLcB/hqdefault.jpg" alt="Git Versioned PDF Visualizer" /></figure><div><h2 class="related__text">Git Versioned PDF Visualizer</h2></div></a></article></div></div></section></main><footer class="footer section-padding"><div class="grid"><div class="subscribe" id="subscribe"><div class="subscribe__container"> <span class="subscribe__title">Subscribe</span><p class="subscribe__text">Get an update when I post new content.</p><form method="POST" action="https://bonkerfield.us4.list-manage.com/subscribe/post-json?u=68d1146ea8fe327def203f254&amp;id=e88ba623c5&amp;c=?" id="mc-signup" name="mc-embedded-subscribe-form" novalidate><div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_68d1146ea8fe327def203f254_e88ba623c5" tabindex="-1" value=""></div><div class="form-group"> <input id="mce-EMAIL" type="email" name="EMAIL" placeholder="Email Address"></div><div class="form__btn"> <input id="mc-submit" type="submit" value="Sign Up" name="subscribe"></div></form><p class="subscribe__error hidden"></p></div></div><hr class="sep--white"/><div class="footer__container"><ul class="footer__social"><li><a href="https://twitter.com/willstedden" target="_blank"><i class="fa fa-twitter"></i></a></li><li><a href="https://www.instagram.com/" target="_blank"><i class="fa fa-instagram"></i></a></li><li><a href="https://www.linkedin.com/in/willstedden" target="_blank"><i class="fa fa-linkedin"></i></a></li><li><a href="https://github.com/stedn" target="_blank"><i class="fa fa-github"></i></a></li><li><a href="https://codepen.io/stedn/" target="_blank"><i class="fa fa-codepen"></i></a></li></ul><div class="widget-content"> <form style="text-align:center" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" style="width:10%"> <input type="hidden" name="cmd" value="_s-xclick"> <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7----- "> <input type="submit" value="donate" name="submit" style="width:15%;"> </form></div><div class="posts__pagination"> <span>All content on this blog is free to use under a creative commons <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a> license</span></div></div></div></footer><section class="contact popup"><div class="popup__close"><div class="popup__exit"></div></div><div class="contact__container popup__container"><div class="contact__img"><figure class="absolute-bg" style="background-image: url(/assets/images/main/octopus.jpeg);"></figure></div><div class="contact__content"><div class="contact__mast section-padding--half"><div class="grid"><h2>Contact</h2></div></div><div class="section-padding--none"><hr class="sep"/></div><div class="contact__form section-padding--half"><div class="grid-xlarge"> <form id="form" class="form" action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSctE1VauB_r8xR0tsfPas21pTUqKg-5vC8zXgl_eRjJW2FP_g/formResponse" method="POST"><div class="form__subcontainer"><div> <label for="form-first-name">first name</label> <input type="text" name="entry.1565830609" id="form-first-name" required></div><div> <label for="form-last-name">last name</label> <input type="text" name="entry.1397370877" id="form-last-name" required></div></div><div> <label for="form-email">email</label> <input type="email" name="entry.644994945" id="form-email" required></div><div> <label for="form-message">message</label> <textarea name="entry.918842698" id="form-message" rows="3"></textarea></div><div class="form__submit"><div class="form__btn"> <input type="submit" value="Send"></div></div><p class="form__message"></p></form></div></div></div></div></section><script src="/assets/js/app.min.js"></script></body></html>
  